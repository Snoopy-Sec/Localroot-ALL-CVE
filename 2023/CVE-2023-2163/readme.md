{"payload":{"allShortcutsEnabled":false,"fileTree":{"pocs/linux/cve-2023-2163":{"items":[{"name":"include","path":"pocs/linux/cve-2023-2163/include","contentType":"directory"},{"name":"Makefile","path":"pocs/linux/cve-2023-2163/Makefile","contentType":"file"},{"name":"exploit.c","path":"pocs/linux/cve-2023-2163/exploit.c","contentType":"file"},{"name":"exploit_prims.c","path":"pocs/linux/cve-2023-2163/exploit_prims.c","contentType":"file"},{"name":"kernel_helpers.c","path":"pocs/linux/cve-2023-2163/kernel_helpers.c","contentType":"file"},{"name":"readme.md","path":"pocs/linux/cve-2023-2163/readme.md","contentType":"file"}],"totalCount":6},"pocs/linux":{"items":[{"name":"bleedingtooth","path":"pocs/linux/bleedingtooth","contentType":"directory"},{"name":"cve-2021-22555","path":"pocs/linux/cve-2021-22555","contentType":"directory"},{"name":"cve-2023-2163","path":"pocs/linux/cve-2023-2163","contentType":"directory"},{"name":"kernelctf","path":"pocs/linux/kernelctf","contentType":"directory"},{"name":"kvm_vma","path":"pocs/linux/kvm_vma","contentType":"directory"},{"name":"kvmctf","path":"pocs/linux/kvmctf","contentType":"directory"}],"totalCount":6},"pocs":{"items":[{"name":"apple","path":"pocs/apple","contentType":"directory"},{"name":"azure","path":"pocs/azure","contentType":"directory"},{"name":"bios","path":"pocs/bios","contentType":"directory"},{"name":"bleve","path":"pocs/bleve","contentType":"directory"},{"name":"cpus","path":"pocs/cpus","contentType":"directory"},{"name":"grub","path":"pocs/grub","contentType":"directory"},{"name":"kakadu","path":"pocs/kakadu","contentType":"directory"},{"name":"linux","path":"pocs/linux","contentType":"directory"},{"name":"log4j","path":"pocs/log4j","contentType":"directory"},{"name":"oracle","path":"pocs/oracle","contentType":"directory"}],"totalCount":10},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"analysis","path":"analysis","contentType":"directory"},{"name":"kernelctf","path":"kernelctf","contentType":"directory"},{"name":"kvmctf","path":"kvmctf","contentType":"directory"},{"name":"pocs","path":"pocs","contentType":"directory"},{"name":"v8ctf","path":"v8ctf","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"CONTRIBUTING.md","path":"CONTRIBUTING.md","contentType":"file"},{"name":"LICENSE","path":"LICENSE","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"SECURITY.md","path":"SECURITY.md","contentType":"symlink_file"}],"totalCount":11}},"fileTreeProcessingTime":6.275463,"foldersToFetch":[],"repo":{"id":272394704,"defaultBranch":"master","name":"security-research","ownerLogin":"google","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2020-06-15T09:19:51.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/1342004?v=4","public":true,"private":false,"isOrgOwned":true},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"master","listCacheKey":"v0:1705762328.0","canEdit":false,"refType":"branch","currentOid":"c79c9829bda8b5111174e5806fb3b12126a6f66e"},"path":"pocs/linux/cve-2023-2163/readme.md","currentUser":null,"blob":{"rawLines":null,"stylingDirectives":null,"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/google/security-research/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null},"displayName":"readme.md","displayUrl":"https://github.com/google/security-research/blob/master/pocs/linux/cve-2023-2163/readme.md?raw=true","headerInfo":{"blobSize":"666 Bytes","deleteTooltip":"You must be signed in to make or propose changes","editTooltip":"You must be signed in to make or propose changes","deleteInfo":{"deleteTooltip":"You must be signed in to make or propose changes"},"editInfo":{"editTooltip":"You must be signed in to make or propose changes"},"ghDesktopPath":"https://desktop.github.com","isGitLfs":false,"gitLfsPath":null,"onBranch":true,"shortPath":"01fb3c4","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsecurity-research%2Fblob%2Fmaster%2Fpocs%2Flinux%2Fcve-2023-2163%2Freadme.md","isCSV":false,"isRichtext":true,"toc":[{"level":1,"text":"CVE-2023-2163: Path pruning gone wrong","anchor":"cve-2023-2163-path-pruning-gone-wrong","htmlText":"CVE-2023-2163: Path pruning gone wrong"},{"level":2,"text":"Technical details","anchor":"technical-details","htmlText":"Technical details"},{"level":2,"text":"Usage","anchor":"usage","htmlText":"Usage"},{"level":2,"text":"Credits","anchor":"credits","htmlText":"Credits"}],"lineInfo":{"truncatedLoc":"24","truncatedSloc":"17"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Markdown","languageID":222,"large":false,"loggedIn":false,"planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/google/security-research/blob/master/pocs/linux/cve-2023-2163/readme.md","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","releasePath":"/google/security-research/releases/new?marketplace=true","showPublishActionBanner":false},"rawBlobUrl":"https://github.com/google/security-research/raw/master/pocs/linux/cve-2023-2163/readme.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><h1 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-cve-2023-2163-path-pruning-gone-wrong\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#cve-2023-2163-path-pruning-gone-wrong\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>CVE-2023-2163: Path pruning gone wrong</h1>\n<p dir=\"auto\">This Proof-Of-Concept demonstrates the exploitation of <a href=\"https://github.com/google/security-research/security/advisories/GHSA-j87x-j6mh-mv8v\">CVE-2023-2163</a>.</p>\n<h2 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-technical-details\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#technical-details\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Technical details</h2>\n<p dir=\"auto\">A bug in the eBPF Verifier branch pruning logic can lead to unsafe code paths\nbeing incorrectly marked as safe. As demonstrated in the exploitation section,\nthis can be leveraged to get arbitrary read/write in kernel memory,\nleading to LPE and Container escape.</p>\n<h2 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-usage\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#usage\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Usage</h2>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$ make\n$ ./exploit\"><pre>$ make\n$ ./exploit</pre></div>\n<h2 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-credits\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#credits\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Credits</h2>\n<p dir=\"auto\">Juan Jose Lopez Jaimez (@thatjiaozi)\nMeador Inge (@meadori)\nSimon Scannell (@scannell_simon)\nValentina Palmiotti (@chompie1337)</p>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"google","repoName":"security-research","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timed_out":false,"not_analyzed":false,"symbols":[{"name":"CVE-2023-2163: Path pruning gone wrong","kind":"section_1","ident_start":2,"ident_end":40,"extent_start":0,"extent_end":666,"fully_qualified_name":"CVE-2023-2163: Path pruning gone wrong","ident_utf16":{"start":{"line_number":0,"utf16_col":2},"end":{"line_number":0,"utf16_col":40}},"extent_utf16":{"start":{"line_number":0,"utf16_col":0},"end":{"line_number":24,"utf16_col":0}}},{"name":"Technical details","kind":"section_2","ident_start":203,"ident_end":220,"extent_start":200,"extent_end":486,"fully_qualified_name":"Technical details","ident_utf16":{"start":{"line_number":4,"utf16_col":3},"end":{"line_number":4,"utf16_col":20}},"extent_utf16":{"start":{"line_number":4,"utf16_col":0},"end":{"line_number":11,"utf16_col":0}}},{"name":"Usage","kind":"section_2","ident_start":489,"ident_end":494,"extent_start":486,"extent_end":526,"fully_qualified_name":"Usage","ident_utf16":{"start":{"line_number":11,"utf16_col":3},"end":{"line_number":11,"utf16_col":8}},"extent_utf16":{"start":{"line_number":11,"utf16_col":0},"end":{"line_number":18,"utf16_col":0}}},{"name":"Credits","kind":"section_2","ident_start":529,"ident_end":536,"extent_start":526,"extent_end":666,"fully_qualified_name":"Credits","ident_utf16":{"start":{"line_number":18,"utf16_col":3},"end":{"line_number":18,"utf16_col":10}},"extent_utf16":{"start":{"line_number":18,"utf16_col":0},"end":{"line_number":24,"utf16_col":0}}}]}},"copilotInfo":null,"copilotAccessAllowed":false,"csrf_tokens":{"/google/security-research/branches":{"post":"ykn11TE_OIeiNXZfuSC109RHIWbEkWJrJvJqoObkqLIiLqrvvbAVsy60usPG1w6iX9CLlwMN1fLc32g0u7hYoA"},"/repos/preferences":{"post":"biLRPT91Ms1AbKxyXCESV1eLPt5XmVnQUR_payeknsJ3s8XsWrog1PpQbw1zwnSLwzf8Sgmyx5tz4hyk8etKGA"}}},"title":"security-research/pocs/linux/cve-2023-2163/readme.md at master · google/security-research"}